### 状态模式

**学自《Head First 设计模式》**

#### 原始需求

糖果厂里有糖果机，包含4个状态：有1元、无1元、出售糖果、糖果售罄

- 状态转换
    + 无1元 -> 投币1元 -> 有1元
    + 有1元
        * 转动曲柄 -> 出售糖果
        * 退回1元 -> 无1元
    + 出售糖果
        * 发放糖果1颗 -> 糖果数目>0 -> 无1元
        * 发放糖果1颗 -> 糖果数目=0 -> 糖果售罄
    + 糖果售罄 -> 投入糖果 -> 无1元

#### [糟糕的设计](./bad)

使用if语句来完成状态转换逻辑，使得代码可读性变差且不易维护和扩展

---

#### 需求更改

在原始需要的基础上，添加逻辑：当用户转动曲柄时，有10%的机会成为赢家，而赢家可以一次获得2颗糖果

- 状态转换
    + 无1元 -> 投币1元 -> 有1元
    + 有1元
        * 转动曲柄 -> 赢家
        * 转动曲柄 -> 出售糖果
        * 退回1元 -> 无1元
    + 出售糖果
        * 发放糖果1颗 -> 糖果数目>0 -> 无1元
        * 发放糖果1颗 -> 糖果数目=0 -> 糖果售罄
    + 赢家
        * 发放糖果2颗 -> 糖果数目>0 -> 无1元
        * 发放糖果2颗 -> 糖果数目=0 -> 糖果售罄
    + 糖果售罄 -> 投入糖果 -> 无1元

#### [状态模式](./state)

状态模式：允许对象在内部状态改变时改变它的行为，对象看起来好像修改了它的类